# candidate 配下リファクタリング診断・設計書（第 4 部：求人検索・応募・お気に入り・ダッシュボード）

---

## 1. カテゴリ概要

この部では、`/candidate/search/setting/`・`/candidate/job/`・`/candidate/mypage/`配下の**求人検索・
応募・お気に入り・ダッシュボード**に関する全ページ・ロジックを徹底的に精査し、**リファクタリング必須
箇所とその理由・改善案**を厳密に記述します。

---

## 2. 求人検索・詳細

### 2.1 対象ファイル

- `search/setting/CandidateSearchClient.tsx`
- `search/setting/SearchForm.tsx`
- `search/setting/[id]/CandidateSearchSettingClient.tsx`
- `job/[job_id]/JobDetailView.tsx`

### 2.2 主な問題点・リファクタリング推奨理由

#### a. 検索条件管理・ページネーション・お気に入り管理ロジックの肥大化

- **現状**：状態管理・URL 同期・API 呼び出し・UI 描画が密結合。
- **理由**：保守性・テスト容易性・パフォーマンスの低下。
- **改善案**：
  - 状態管理・ロジックの分離（カスタムフック化）。
  - 型・UI 部品の共通化。

#### b. UI 部品・props/型の一貫性不足

- **現状**：JobSearchResult 型や pagination 型が分散。UI 部品（検索フォーム、タグ、ページネーション
  等）の重複。
- **理由**：UI 一貫性・保守性の低下。
- **改善案**：
  - 共通型・UI 部品の一元化。

#### c. 副作用（useEffect）やイベントハンドラの肥大化

- **現状**：副作用やイベントハンドラが肥大化し、可読性が低下。
- **理由**：保守性・テスト容易性の低下。
- **改善案**：
  - ロジック分離・カスタムフック化。

---

## 3. 応募

### 3.1 対象ファイル

- `search/setting/[id]/confirm/CandidateApplicationClient.tsx`
- `search/setting/[id]/confirm/actions.ts`

### 3.2 主な問題点・リファクタリング推奨理由

#### a. ファイルアップロード・バリデーション・応募処理ロジックの肥大化

- **現状**：状態管理・UI 描画・バリデーションが密結合。
- **理由**：保守性・テスト容易性・UX の低下。
- **改善案**：
  - ロジック分離（カスタムフック化）、UI 部品共通化、型の一元化。

#### b. サーバーアクションの重複

- **現状**：ファイルアップロード・応募処理の重複。エラーハンドリングの粒度不足。
- **理由**：堅牢性・保守性の低下。
- **改善案**：
  - 共通アクションユーティリティ化。

---

## 4. お気に入り

### 4.1 対象ファイル

- `job/favorite/CandidateFavoriteClient.tsx`
- `job/favorite/actions.ts`

### 4.2 主な問題点・リファクタリング推奨理由

#### a. お気に入り管理・ページネーション・UI 描画ロジックの肥大化

- **現状**：状態管理・UI 描画・イベントハンドラが密結合。
- **理由**：保守性・テスト容易性・UX の低下。
- **改善案**：
  - ロジック分離・UI 部品共通化。

#### b. サーバーアクションの重複

- **現状**：お気に入り追加/削除/取得の CRUD ロジックが他アクションと重複。エラーハンドリングの粒度不
  足。
- **理由**：堅牢性・保守性の低下。
- **改善案**：
  - 共通アクションユーティリティ化。

---

## 5. ダッシュボード

### 5.1 対象ファイル

- `mypage/CandidateDashboardClient.tsx`
- `mypage/CandidateDashboardServer.tsx`
- `mypage/actions.ts`

### 5.2 主な問題点・リファクタリング推奨理由

#### a. タスク・メッセージ・求人・お知らせ管理ロジックの肥大化

- **現状**：状態管理・UI 描画・イベントハンドラが密結合。
- **理由**：保守性・拡張性・テスト容易性の低下。
- **改善案**：
  - ロジック分離・UI 部品共通化、型の一元化。

#### b. サーバー側データ取得・型定義の重複

- **現状**：サーバー側データ取得・型定義が重複。
- **理由**：保守性・堅牢性の低下。
- **改善案**：
  - データ取得ロジックの共通化。

#### c. サーバーアクションの重複

- **現状**：タスク・メッセージ・求人・お知らせ取得の CRUD ロジックが他アクションと重複。エラーハンド
  リングの粒度不足。
- **理由**：堅牢性・保守性の低下。
- **改善案**：
  - 共通アクションユーティリティ化。

---

## 6. 横断的な改善方針

- **状態管理/アクション/バリデーション/エラー表示/型/UI 部品/CRUD 操作の共通化・一貫性強化**
- **カスタムフック化・ロジック共通化**
- **UI 部品の props/型/スタイル統一・共通化**
- **アクセシビリティ・UI/UX 一貫性の強化**
